function gdlpafg_attachHandlers(e){function t(e){var t,i=e.querySelector(".video"),n=e.querySelector(".vcontainer"),l=e.querySelector("video"),a=e.querySelector(".vcontainer span.counter"),o=e.querySelector(".vcontainer li.messages_countdown"),r=e.querySelector(".vcontainer li.messages_done"),s=e.querySelector(".vcontainer .finished"),c=e.querySelector(".afg_charity_chooser"),y=!1;return function(d){function f(e,t,i){return function(){var n=t.getBoundingClientRect(),l=e.getBoundingClientRect(),a=l.width/n.width,o=l.height/n.height,r=l.left-n.left,s=l.top-n.top,c="translateX("+r+"px) translateY("+s+"px) scaleX("+a+") scaleY("+o+")";t.style.transform=c,setTimeout(i,100)}}function u(){x&&A&&(_=!0,s.style.width=l.offsetWidth+"px",s.style.height=l.offsetHeight+"px",l.style.display="none",r.style.display="none",s.style.display="flex",I&&(s.style.display="-ms-flexbox"))}function p(){c.style.bottom=i.offsetHeight-l.offsetHeight-l.offsetTop+28+"px",c.classList.add("showing")}function g(){E-=1,a.innerHTML=E.toString(),E<=0&&(clearInterval(t),o.style.display="none",p())}if((!d.target||d.target!=i&&!i.contains(d.target))&&!y){i.style.display="block";var v=i.getBoundingClientRect(),h=e.getBoundingClientRect();i.style.display="none";var m=h.width/v.width,S=h.height/v.height,b=h.left-v.left,q=h.top-v.top,w="translateX("+b+"px) translateY("+q+"px) scaleX("+m+") scaleY("+S+")";i.style.transform=w,e.style.visibility="hidden",i.style.visibility="visible",i.style.display="block",setTimeout(function(){i.style.transition="all 100ms ease-out",i.style.transform=""},0);var x=!1,A=!1;l.addEventListener("ended",function(){A=!0,u()},!1);var L=e.querySelector("button.close"),_=!1;if(L){var k=function(e){var t=e.querySelector(".video");return f(e,t,function(){e.style.visibility="visible",t.style.display="none",t.style.transform="",t.style.transition=""})}(e),T=function(e){var t=e.querySelector(".video"),i=e.querySelector(".thankyou");return f(e,t,function(){y=!0,t.style.display="none",t.style.transform="",t.style.transition="",i.style.display="block",i.style.visibility="visible"})}(e);L.onclick=function(){l.pause(),n.style.display="none",clearInterval(t),_?T():k()}}n.style.display="flex",o.style.display="block";var E=15;Array.prototype.slice.call(e.querySelectorAll(".afg_video_charities li")).forEach(function(t){t.onclick=function(){x=t.getElementsByTagName("span")[0].firstChild.nodeValue,Array.prototype.slice.call(e.querySelectorAll(".afg_charity_name")).forEach(function(e){e.innerHTML=e.innerHTML.replace("$charity",x)}),r.style.display="block",u(),c.classList.remove("showing"),M&&l.play()}});var H=navigator.userAgent||navigator.vendor||window.opera,M=/iPad|iPhone|iPod/.test(H)&&!window.MSStream;M?(o.style.display="none",p()):(l.play(),t=setInterval(g,1e3),g());var B=H.indexOf("MSIE "),C=H.indexOf("Trident/"),I=B>0||C>0;I&&(n.style.display="-ms-flexbox")}}}Array.prototype.slice.call(document.querySelectorAll(".gdlpafg")).forEach(function(i){var n=Array.prototype.slice.call(i.querySelectorAll(".afg_charities li"));if(n.length>0){n[0].classList.add("showing");var l=0;setInterval(function(){n[l].classList.remove("showing"),l+=1,l==n.length&&(l=0),n[l].classList.add("showing")},4e3)}Array.prototype.slice.call(i.querySelectorAll(".afg_company_name")).forEach(function(t){t.innerHTML=t.innerHTML.replace("$company",e)});var a=!1,o="Webkit Moz O ms Khtml".split(" "),r="",s=document.createElement("div");if(void 0!==s.style.animationName&&(a=!0),a===!1)for(var c=0;c<o.length;c++)if(void 0!==s.style[o[c]+"AnimationName"]){r=o[c],r+"Animation","-"+r.toLowerCase()+"-",a=!0;break}if(a){var y=i.getElementsByTagName("header");y.length>0&&y[0].classList.add("animatable")}i.onclick=t(i)})}